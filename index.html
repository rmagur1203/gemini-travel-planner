<!DOCTYPE html>
<html>
  <head>
    <title>Interactive Map Explorer</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Font Awesome CDN -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <!-- Tailwind CSS Play CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="importmap">
      {
        "imports": {
          "@google/genai": "https://esm.sh/@google/genai@^0.7.0"
        }
      }
    </script>
  </head>
  <body>
    <!-- Semi-transparent overlay displayed when timeline is open on mobile -->
    <div class="fixed inset-0 bg-black/50 z-9 hidden" id="map-overlay"></div>

    <!-- Sliding panel for displaying the day plan timeline -->
    <div
      class="fixed top-0 right-0 w-80 h-full bg-white/98 backdrop-blur-[10px] shadow-[-2px_0_15px_rgba(0,0,0,0.1)] z-[1000] overflow-hidden hidden transition-transform duration-300 ease-in-out"
      id="timeline-container"
    >
      <!-- Button to toggle timeline visibility on mobile -->
      <button
        id="timeline-toggle"
        class="absolute top-1/2 left-[-40px] -translate-y-1/2 w-10 h-10 bg-white rounded-l-lg flex items-center justify-center cursor-pointer shadow-[-2px_0_10px_rgba(0,0,0,0.1)] border-0 hidden"
      >
        <i class="fas fa-calendar-alt"></i>
      </button>

      <div
        class="sticky top-0 p-4 flex justify-between items-center border-b border-[#eeeeee] bg-white z-2"
      >
        <h3 class="text-base font-semibold text-[#333]">Your Day Plan</h3>
        <div class="flex gap-2">
          <button
            id="export-plan"
            class="bg-transparent border-none cursor-pointer text-sm text-[#666] flex items-center p-1 px-2 rounded transition-colors duration-200 hover:bg-[#f0f0f0] hover:text-[#333]"
          >
            <i class="fas fa-download"></i> Export
          </button>
          <button
            id="close-timeline"
            class="bg-transparent border-none cursor-pointer text-sm text-[#666] flex items-center p-1 px-2 rounded transition-colors duration-200 hover:bg-[#f0f0f0] hover:text-[#333]"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>
      </div>
      <div
        class="p-0 px-4 pb-4 overflow-y-auto h-[calc(100%-64px)]"
        id="timeline"
      >
        <!-- Timeline items representing the day plan will be inserted here -->
      </div>
    </div>

    <!-- End of elements inside map-container -->

    <!-- Google Maps JavaScript API script -->
    <script>
      // Script to load the Google Maps JavaScript API asynchronously.
      ((g) => {
        var h,
          a,
          k,
          p = "The Google Maps JavaScript API",
          c = "google",
          l = "importLibrary",
          q = "__ib__",
          m = document,
          b = window;
        b = b[c] || (b[c] = {});
        var d = b.maps || (b.maps = {}),
          r = new Set(),
          e = new URLSearchParams(),
          u = () =>
            h ||
            (h = new Promise(async (f, n) => {
              await (a = m.createElement("script"));
              e.set("libraries", [...r] + "");
              for (k in g)
                e.set(
                  k.replace(/[A-Z]/g, (t) => "_" + t[0].toLowerCase()),
                  g[k]
                );
              e.set("callback", c + ".maps." + q);
              a.src = `https://maps.${c}apis.com/maps/api/js?` + e;
              d[q] = f;
              a.onerror = () => (h = n(Error(p + " could not load.")));
              a.nonce = m.querySelector("script[nonce]")?.nonce || "";
              m.head.append(a);
            }));
        d[l]
          ? console.warn(p + " only loads once. Ignoring:", g)
          : (d[l] = (f, ...n) => r.add(f) && u().then(() => d[l](f, ...n)));
      })({ key: "AIzaSyBoJ_PjvWy-mAvldANHZGaqXQCWS6JW67w", v: "weekly" });
    </script>

    <script>
      tailwind.config = {
        theme: {
          extend: {
            animation: {
              spin: "spin 1s linear infinite",
              dash: "dash 20s linear infinite",
            },
            keyframes: {
              dash: {
                to: { "stroke-dashoffset": "1000" },
              },
            },
          },
        },
      };
    </script>

    <style type="text/tailwind">
      @layer utilities {
        .no-scrollbar::-webkit-scrollbar {
          display: none;
        }
        .no-scrollbar {
          -ms-overflow-style: none;
          scrollbar-width: none;
        }
        .mask-gradient-x {
          -webkit-mask-image: linear-gradient(
            to right,
            transparent 0%,
            black 5%,
            black 95%,
            transparent 100%
          );
          mask-image: linear-gradient(
            to right,
            transparent 0%,
            black 5%,
            black 95%,
            transparent 100%
          );
        }
        input:checked + .slider {
          @apply bg-[#2196F3];
        }
        input:focus + .slider {
          @apply shadow-[0_0_1px_#2196F3];
        }
        input:checked + .slider:before {
          transform: translateX(22px);
        }

        .search-button.loading .fa-arrow-right {
          @apply opacity-0;
        }
        .search-button.loading .spinner {
          @apply opacity-100;
        }
        .map-container-shifted {
          @apply w-[calc(100%-320px)] left-0;
        }
        .timeline-container.visible {
          @apply translate-x-0;
        }
        .map-overlay.visible {
          @apply block;
        }
      }
    </style>
  </body>
</html>
